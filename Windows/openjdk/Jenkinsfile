pipeline {
    agent {
        node {
            label 'WinBuilder'
        }
    }
    stages {
        stage('Setup') {
            steps {
                echo 'cleaning up folders'
                powershell 'remove-item -recurse -force Linux'
                powershell 'remove-item -recurse -force Swarm'
                powershell 'remove-item -recurse -force BuildRoot'
                bat 'mkdir BuildRoot'
                powershell 'Copy-Item -Path Windows/openjdk/* -Destination BuildRoot -Recurse -Force'
            }
        }
        stage('Preparation') {
            steps {
                
                dir('Windows/openjdk') {
                    powershell 'ls'
                    bat 'docker pull mcr.microsoft.com/windows/servercore:2004'
                    bat 'docker-compose build'
                    // bat 'docker push liveforensics/buildbox:2004-jenkinsagent'
                }
                
                
            }
        }
        stage('Builder') {
            steps {
                echo 'do some build magic'
                // dir('VC2015Samples\\scribble') {                    
                //     script {                    
                //         bat 'call C:\\BuildTools\\Common7\\Tools\\VsDevCmd.bat && msbuild.exe scribble.sln /p:Configuration=Debug /p:Platform=x64' 
                //     }
                // }
                
                // bat 'call C:\\BuildTools\\Common7\\Tools\\VsDevCmd.bat'
                

                // powershell 'msbuild --version'
            
            }
        }
    }
}